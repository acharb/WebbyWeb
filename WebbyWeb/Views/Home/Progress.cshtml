
<ul class="nav nav-pills" role="tablist">
    <li class="active">
        <a href="#week" role="tab" data-toggle="tab">
            <i class="material-icons">dashboard</i>
            Week
        </a>
    </li>
    <li class="active">
        <a href="#week" role="tab" data-toggle="tab">
            <i class="material-icons">dashboard</i>
            Month
        </a>
    </li>
</ul>

<div class="col-md-3 dropdown">
    <a class="btn btn-simple dropdown-toggle" data-toggle="dropdown">
        habits
        <b class="caret"></b>
    </a>
    <ul class="dropdown-menu">
        <li>first</li>
    </ul>
</div>

<div class="PieContainer">
  <canvas id="pieChart"></canvas>
</div>



<div id="piechart" style="width: 900px; height: 500px;"></div>

<script>
  FormatPage();
  PopulatePage();

  function CreatePieChartFromArray(completeArray){

    var todaysDone = completeArray[0];
    var todaysLeft = completeArray[1]-todaysDone;
    var totalLeft = completeArray[1]*7 - todaysDone;

    var ctxP = document.getElementById("pieChart").getContext('2d');
    var myPieChart = new Chart(ctxP, {
        type: 'pie',
        data: {
            labels: ["today's complete", "today's left", "total left"],
            datasets: [
                {
                    data: [todaysDone, todaysLeft, totalLeft],
                    backgroundColor: ["green", "blue", "darkblue"],
                    hoverBackgroundColor: ["lightgreen", "yellow", "darkblue"]
                }
            ]
        },
        options: {
            responsive: true
        }    
    });
  };

  // get progress and create pie chart
  function PopulatePage(){
      var ret = $.ajax(
              {
                  type:"GET",
                  url:"/Home/GetProgress",
                  success: function(data){
                      
                      var completeArray = CalculateHabitsComplete(data);
                      CreatePieChartFromArray(completeArray);
                  }
              }
          );
      return ret.success();
  };

  //return array [habits complete (by time), total habits (by times)]
  function CalculateHabitsComplete(data){
      console.log(data);
      var numberOfHabits = 0;
      var habitsComplete = 0;
      //cycle through each habit
      for(var entityIndex=0;entityIndex<data.length;entityIndex++)
        {
          var entity = data[entityIndex];
          var doneOrNot = entity.doneOrNot;
          //cycle through each habit done or not
          for(var doneOrNotIndex = 0; doneOrNotIndex<doneOrNot.length;doneOrNotIndex++)
          {
            numberOfHabits+=1;
            if(doneOrNot[doneOrNotIndex]==1)
            {
              habitsComplete+=1;
            };
          };
        };
      var completeArray = [habitsComplete,numberOfHabits];
      return completeArray;
  };


  function FormatPage(){
    //$('#mainCard')[0].className='main';
    //$('#mainCard')[0].style.width='500px';
    $('#mainCard')[0].style.margin='auto';
    $('#mainCard')[0].style.marginTop='-20px';
  };

</script>


